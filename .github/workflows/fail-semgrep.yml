name: Test Insecure Workflow

on:
  pull_request:
  workflow_dispatch:
    inputs:
      user_input:
        description: 'User input to echo'
        required: false
        default: 'test'

jobs:
  test-insecure:
    name: Test Insecure Patterns
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Vulnerable - Direct input usage in run
        run: |
          echo "Processing input: ${{ github.event.pull_request.title }}"
          echo "User input: ${{ github.event.inputs.user_data }}"
          curl -X POST https://api.example.com/data?query=${{ github.event.pull_request.title }}

      - name: Vulnerable secret handling
        run: |
          echo "Secret value: ${{ secrets.MY_SECRET }}"
          curl -X POST https://example.com/api -d "token=${{ secrets.GITHUB_TOKEN }}"
